(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{390:function(e,t,a){},795:function(e,t,a){"use strict";var r=a(390);a.n(r).a},800:function(e,t,a){"use strict";a.r(t);a(182),a(763),a(114),a(70),a(765),a(766),a(767),a(101),a(10),a(46),a(770),a(362),a(28),a(71),a(177),a(773),a(32),a(193);var r,i=a(774),n=a(99),o=(a(100),a(52)),s=a(775),c=a.n(s),l=a(776),u=a.n(l),p=a(794),d=a.n(p),h={components:{},props:{},data:function(){return{solrData:null,solrDataDirect:null,devVersion:null,prodVersion:null,phenotypeValue:"percent",diseaseValue:"percent",publicationValue:"percent",otherValue:"percent",phenotypeQualifier:"all",diseaseQualifier:"all",publicationQualifier:"all",otherQualifier:"all",qualifierOptions:[{text:"Direct+Inferred",value:"all"},{text:"Direct Only",value:"direct"}],solrValueOptions:[{text:"Percent change",value:"percent"},{text:"Beta counts",value:"dev"},{text:"Production counts",value:"production"}],phenotypesFetched:!1,diseasesFetched:!1,publicationsFetched:!1,otherFetched:!1,versionFetched:!1,phenotypeAssociations:["case_phenotype","genotype_phenotype","variant_phenotype","disease_phenotype","gene_phenotype"],diseaseAssociations:["model_disease","genotype_disease","variant_disease","disease_pathway","disease_phenotype","marker_disease","gene_disease","chemical_disease"],publicationAssociations:["publication_model","publication_genotype","publication_variant","publication_gene","publication_disease","publication_phenotype"],otherAssociations:["pathway_phenotype","case_variant","case_genotype","case_gene","variant_genotype","variant_gene","genotype_gene","model_case","model_genotype","model_variant","model_gene","gene_anatomy","gene_function","gene_pathway","gene_interaction","gene_homology"]}},mounted:(r=Object(o.a)(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,0)}));case 2:return t="percent",e.next=5,this.getSciGraphVersion();case 5:return this.versionFetched=!0,e.next=8,this.getSolrPivot();case 8:a=e.sent,this.devVersion===this.prodVersion&&(t="production",this.phenotypeValue="production",this.diseaseValue="production",this.publicationValue="production",this.otherValue="production"),this.makeHeatMap(a,this.phenotypeAssociations,"phenotype-heatmap",t),this.phenotypesFetched=!0,this.makeHeatMap(a,this.diseaseAssociations,"disease-heatmap",t),this.diseasesFetched=!0,this.makeHeatMap(a,this.publicationAssociations,"publication-heatmap",t),this.publicationsFetched=!0,this.makeHeatMap(a,this.otherAssociations,"other-heatmap",t),this.otherFetched=!0;case 18:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)}),methods:{getSciGraphVersion:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var a,r,i,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=window.sessionStorage,null!==e.prodVersion||null!==a.getItem("prodVersion")){t.next=14;break}return t.next=4,e.fetchSciGraphVersion();case 4:r=t.sent,i=Object(n.a)(r,2),o=i[0],s=i[1],e.devVersion=o,e.prodVersion=s,a.setItem("devVersion",JSON.stringify(o)),a.setItem("prodVersion",JSON.stringify(s)),t.next=15;break;case 14:null!==a.getItem("prodVersion")&&(e.prodVersion=JSON.parse(a.getItem("prodVersion")),e.devVersion=JSON.parse(a.getItem("devVersion")));case 15:case"end":return t.stop()}}),t)})))()},_processSciGraphVersion:function(e){var t,a,r=Object(i.a)(e.data.edges);try{for(r.s();!(a=r.n()).done;){var n=a.value;if("dcat:distribution"===n.pred&&n.sub.endsWith("#ncbigene")){t=n.sub.replace("MonarchArchive:","https://archive.monarchinitiative.org/").replace("/#ncbigene","");break}}}catch(e){r.e(e)}finally{r.f()}return t},fetchSciGraphVersion:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var a,r,i,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"https://scigraph-data.monarchinitiative.org/scigraph/dynamic/datasets.json","https://scigraph-data-dev.monarchinitiative.org/scigraph/dynamic/datasets.json",t.next=4,Promise.all([e.getSciGraphData("https://scigraph-data-dev.monarchinitiative.org/scigraph/dynamic/datasets.json"),e.getSciGraphData("https://scigraph-data.monarchinitiative.org/scigraph/dynamic/datasets.json")]);case 4:return a=t.sent,r=Object(n.a)(a,2),i=r[0],o=r[1],t.abrupt("return",[e._processSciGraphVersion(i),e._processSciGraphVersion(o)]);case 9:case"end":return t.stop()}}),t)})))()},updateSolrData:function(e,t,a,r){var i=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i.setSpinner(r,!1),n.next=3,i.getSolrPivot(t);case 3:o=n.sent,i.makeHeatMap(o,a,r,e),i.setSpinner(r,!0);case 6:case"end":return n.stop()}}),n)})))()},makeHeatMap:function(e,t,a){var r,o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"percent",l=Object.keys(e.solrDev.gene_phenotype),u=[],p=this.getCountsFromSolr(e.solrDev,t),d=this.getCountsFromSolr(e.solrProd,t),h=p.map((function(e,t){return e.map((function(e,a){var r=d[t][a];return 0===e&&0!==r?-100:0===e&&0===r?0:0!==e&&0===r?100*e:(e-r)/r*100}))})),v=Object(i.a)(t.entries());try{for(v.s();!(o=v.n()).done;){var f,b=Object(n.a)(o.value,2),m=b[0],g=b[1],y=[],_=Object(i.a)(l.entries());try{for(_.s();!(f=_.n()).done;){var w=Object(n.a)(f.value,2),S=w[0],V=w[1];y.push("Source: ".concat(V,"<br>")+"Association: ".concat(g,"<br>")+"Percent change: ".concat(h[m][S].toFixed(2).toLocaleString(),"%<br>")+"Beta count: ".concat(p[m][S].toLocaleString(),"<br>")+"Production count: ".concat(d[m][S].toLocaleString(),"<br>"))}}catch(e){_.e(e)}finally{_.f()}u.push(y)}}catch(e){v.e(e)}finally{v.f()}"percent"===s?r=h:"dev"===s?r=p:"production"===s&&(r=d);var D={autosize:!1,margin:{l:155,r:0,t:80,b:80},height:23*t.length+160,width:920,xaxis:{tickangle:45,tickfont:{size:13.5},showgrid:!1},yaxis:{tickfont:{size:13},showgrid:!1}},x=[{z:r,x:l,y:t,type:"heatmap",hoverongaps:!1,hoverinfo:"text",text:u,xgap:3,ygap:3}];"percent"===s?(x[0].zmin=-100,x[0].zmax=100,x[0].colorscale=[["0.0","rgb(165,0,38)"],["0.49","rgb(215,48,39)"],["0.5","rgb(255,255,255)"],["0.51","rgb(69,117,180)"],["1.0","rgb(49,54,149)"]]):x[0].colorscale=[["0","rgb(255,255,255)"],["0.0001","rgb(116,173,209)"],["0.5","rgb(69,117,180)"],["1.0","rgb(49,54,149)"]],c.a.newPlot(a,x,D)},processSource:function(e){return d.a.basename(e).replace("#","").replace(".ttl","").replace(".nt","")},getCountsFromSolr:function(e,t){var a,r=[],n=Object.keys(e.gene_phenotype),o=Object(i.a)(t);try{for(o.s();!(a=o.n()).done;){var s,c=a.value,l=[],u=Object(i.a)(n);try{for(u.s();!(s=u.n()).done;){var p=s.value;l.push(e[c][p])}}catch(e){u.e(e)}finally{u.f()}r.push(l)}}catch(e){o.e(e)}finally{o.f()}return r},getSolrPivot:function(){var e=arguments,t=this;return Object(o.a)(regeneratorRuntime.mark((function a(){var r,i,n;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=e.length>0&&void 0!==e[0]?e[0]:"all",n=window.sessionStorage,"all"!==r){a.next=14;break}if(null!==t.solrData||null!==n.getItem("solrData")){a.next=11;break}return a.next=6,t.fetchSolrPivot("all");case 6:i=a.sent,t.solrData=i,n.setItem("solrData",JSON.stringify(i)),a.next=12;break;case 11:null!==n.getItem("solrData")?(t.solrData=JSON.parse(n.getItem("solrData")),i=t.solrData):i=t.solrData;case 12:a.next=24;break;case 14:if("direct"!==r){a.next=24;break}if(null!==t.solrDataDirect||null!==n.getItem("solrDataDirect")){a.next=23;break}return a.next=18,t.fetchSolrPivot("direct");case 18:i=a.sent,t.solrDataDirect=i,n.setItem("solrDataDirect",JSON.stringify(i)),a.next=24;break;case 23:null!==!n.getItem("solrDataDirect")?(t.solrDataDirect=JSON.parse(n.getItem("solrDataDirect")),i=t.solrDataDirect):i=t.solrDataDirect;case 24:return a.abrupt("return",i);case 25:case"end":return a.stop()}}),a)})))()},fetchSolrPivot:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function a(){var r,o,s,c,l,u,p,d,h,v,f,b,m,g,y,_,w,S,V,D,x,O,k,j,F,A;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r={solrDev:{},solrProd:{}},"https://solr.monarchinitiative.org/solr/golr/select/","https://solr-dev.monarchinitiative.org/solr/golr/select/",o={wt:"json",facet:!0,"json.nl":"arrarr",rows:0,q:"*:*","facet.pivot.mincount":0,"facet.pivot":"association_type,is_defined_by","facet.limit":"500"},"direct"===e&&(o.fq="qualifier:direct"),s={solrDev:{},solrProd:{}},a.next=8,Promise.all([t.getSolrData("https://solr-dev.monarchinitiative.org/solr/golr/select/",o),t.getSolrData("https://solr.monarchinitiative.org/solr/golr/select/",o)]);case 8:c=a.sent,l=Object(n.a)(c,2),u=l[0],p=l[1],s.solrDev=u.data.facet_counts.facet_pivot["association_type,is_defined_by"],s.solrProd=p.data.facet_counts.facet_pivot["association_type,is_defined_by"],d=s.solrDev.flatMap((function(e){return e.pivot.map((function(e){return t.processSource(e.value)}))})),h=s.solrProd.flatMap((function(e){return e.pivot.map((function(e){return t.processSource(e.value)}))})),v=Array.from(new Set(d.concat(h))).sort(),f=t.phenotypeAssociations.concat(t.diseaseAssociations).concat(t.otherAssociations).concat(t.publicationAssociations),b=Object(i.a)(f);try{for(b.s();!(m=b.n()).done;){g=m.value,r.solrDev[g]={},r.solrProd[g]={},y=Object(i.a)(v);try{for(y.s();!(_=y.n()).done;)w=_.value,r.solrDev[g][w]=0,r.solrProd[g][w]=0}catch(e){y.e(e)}finally{y.f()}}}catch(e){b.e(e)}finally{b.f()}for(S in s){V=Object(i.a)(s[S]);try{for(V.s();!(D=V.n()).done;){x=D.value,O=x.value,k=Object(i.a)(x.pivot);try{for(k.s();!(j=k.n()).done;)F=j.value,A=t.processSource(F.value),r[S][O][A]=F.count}catch(e){k.e(e)}finally{k.f()}}}catch(e){V.e(e)}finally{V.f()}}return a.abrupt("return",r);case 22:case"end":return a.stop()}}),a)})))()},getSolrData:function(e,t){return Object(o.a)(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",u.a.get(e,{params:t}));case 1:case"end":return a.stop()}}),a)})))()},getSciGraphData:function(e){return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",u.a.get(e));case 1:case"end":return t.stop()}}),t)})))()},setSpinner:function(e,t){e.startsWith("phenotype")?this.phenotypesFetched=t:e.startsWith("disease")?this.diseasesFetched=t:e.startsWith("publication")?this.publicationsFetched=t:e.startsWith("other")&&(this.otherFetched=t)}}},v=(a(795),a(26)),f=Object(v.a)(h,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("hr"),e._v(" "),a("div",{staticClass:"scigraph-version"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.versionFetched,expression:"!versionFetched"}],staticClass:"overview-spinner"},[a("b-spinner",{staticClass:"loading-spinner",attrs:{type:"grow",label:"Loading"}})],1),e._v("\n    Production build: "),a("a",{attrs:{href:e.prodVersion,target:"_blank"}},[e._v(e._s(e.prodVersion))]),e._v(" "),a("br"),e._v("\n    Beta build: "),a("a",{attrs:{href:e.devVersion,target:"_blank"}},[e._v(e._s(e.devVersion))])]),e._v(" "),a("div",{staticClass:"chart-title"},[e._v("Phenotype Associations By Source (Solr)")]),e._v(" "),a("b-form-group",[a("b-form-radio-group",{attrs:{id:"phenotype-val-radios",options:e.solrValueOptions,size:"sm",buttons:"",name:"radios-btn-default"},on:{input:function(t){return e.updateSolrData(e.phenotypeValue,e.phenotypeQualifier,e.phenotypeAssociations,"phenotype-heatmap")}},model:{value:e.phenotypeValue,callback:function(t){e.phenotypeValue=t},expression:"phenotypeValue"}})],1),e._v(" "),a("b-form-group",[a("b-form-radio-group",{attrs:{id:"phenotype-qual-radios",options:e.qualifierOptions,size:"sm",buttons:"",name:"radios-btn-default"},on:{input:function(t){return e.updateSolrData(e.phenotypeValue,e.phenotypeQualifier,e.phenotypeAssociations,"phenotype-heatmap")}},model:{value:e.phenotypeQualifier,callback:function(t){e.phenotypeQualifier=t},expression:"phenotypeQualifier"}})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.phenotypesFetched,expression:"!phenotypesFetched"}],staticClass:"overview-spinner"},[a("b-spinner",{staticClass:"loading-spinner",attrs:{type:"grow",label:"Loading"}})],1),e._v(" "),a("div",{staticClass:"chart",attrs:{id:"phenotype-heatmap"}}),e._v(" "),a("div",{staticClass:"chart-title"},[e._v("Disease Associations By Source (Solr)")]),e._v(" "),a("b-form-group",[a("b-form-radio-group",{attrs:{id:"disease-val-radios",options:e.solrValueOptions,size:"sm",buttons:"",name:"radios-btn-default"},on:{input:function(t){return e.updateSolrData(e.diseaseValue,e.diseaseQualifier,e.diseaseAssociations,"disease-heatmap")}},model:{value:e.diseaseValue,callback:function(t){e.diseaseValue=t},expression:"diseaseValue"}})],1),e._v(" "),a("b-form-group",[a("b-form-radio-group",{attrs:{id:"disease-qual-radios",options:e.qualifierOptions,size:"sm",buttons:"",name:"radios-btn-default"},on:{input:function(t){return e.updateSolrData(e.diseaseValue,e.diseaseQualifier,e.diseaseAssociations,"disease-heatmap")}},model:{value:e.diseaseQualifier,callback:function(t){e.diseaseQualifier=t},expression:"diseaseQualifier"}})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.diseasesFetched,expression:"!diseasesFetched"}],staticClass:"overview-spinner"},[a("b-spinner",{staticClass:"loading-spinner",attrs:{type:"grow",label:"Loading"}})],1),e._v(" "),a("div",{staticClass:"chart",attrs:{id:"disease-heatmap"}}),e._v(" "),a("div",{staticClass:"chart-title"},[e._v("Publication Associations By Source (Solr)")]),e._v(" "),a("b-form-group",[a("b-form-radio-group",{attrs:{id:"publication-val-radios",options:e.solrValueOptions,size:"sm",buttons:"",name:"radios-btn-default"},on:{input:function(t){return e.updateSolrData(e.publicationValue,e.publicationQualifier,e.publicationAssociations,"publication-heatmap")}},model:{value:e.publicationValue,callback:function(t){e.publicationValue=t},expression:"publicationValue"}})],1),e._v(" "),a("b-form-group",[a("b-form-radio-group",{attrs:{id:"publication-qual-radios",options:e.qualifierOptions,size:"sm",buttons:"",name:"radios-btn-default"},on:{input:function(t){return e.updateSolrData(e.publicationValue,e.publicationQualifier,e.publicationAssociations,"publication-heatmap")}},model:{value:e.publicationQualifier,callback:function(t){e.publicationQualifier=t},expression:"publicationQualifier"}})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.publicationsFetched,expression:"!publicationsFetched"}],staticClass:"overview-spinner"},[a("b-spinner",{staticClass:"loading-spinner",attrs:{type:"grow",label:"Loading"}})],1),e._v(" "),a("div",{staticClass:"chart",attrs:{id:"publication-heatmap"}}),e._v(" "),a("div",{staticClass:"chart-title"},[e._v("Other Associations By Source (Solr)")]),e._v(" "),a("b-form-group",[a("b-form-radio-group",{attrs:{id:"other-val-radios",options:e.solrValueOptions,size:"sm",buttons:"",name:"radios-btn-default"},on:{input:function(t){return e.updateSolrData(e.otherValue,e.otherQualifier,e.otherAssociations,"other-heatmap")}},model:{value:e.otherValue,callback:function(t){e.otherValue=t},expression:"otherValue"}})],1),e._v(" "),a("b-form-group",[a("b-form-radio-group",{attrs:{id:"other-qual-radios",options:e.qualifierOptions,size:"sm",buttons:"",name:"radios-btn-default"},on:{input:function(t){return e.updateSolrData(e.otherValue,e.otherQualifier,e.otherAssociations,"other-heatmap")}},model:{value:e.otherQualifier,callback:function(t){e.otherQualifier=t},expression:"otherQualifier"}})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.otherFetched,expression:"!otherFetched"}],staticClass:"overview-spinner"},[a("b-spinner",{staticClass:"loading-spinner",attrs:{type:"grow",label:"Loading"}})],1),e._v(" "),a("div",{staticClass:"chart",attrs:{id:"other-heatmap"}})],1)}),[],!1,null,null,null);t.default=f.exports}}]);